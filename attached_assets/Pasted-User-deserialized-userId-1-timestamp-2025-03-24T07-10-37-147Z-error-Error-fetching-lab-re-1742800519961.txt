User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:37.147Z' }
error: Error fetching lab results: {"error":"desc is not defined","stack":"ReferenceError: desc is not defined\n    at <anonymous> (/home/runner/workspace/server/routes/labs.ts:33:49)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at requireAuth (/home/runner/workspace/server/routes.ts:62:5)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at jsonParser (/home/runner/workspace/node_modules/body-parser/lib/types/json.js:113:7)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at strategy.pass (/home/runner/workspace/node_modules/passport/lib/middleware/authenticate.js:355:9)\n    at /home/runner/workspace/node_modules/passport/lib/strategies/session.js:120:12\n    at pass (/home/runner/workspace/node_modules/passport/lib/authenticator.js:352:31)\n    at deserialized (/home/runner/workspace/node_modules/passport/lib/authenticator.js:364:7)\n    at <anonymous> (/home/runner/workspace/server/auth.ts:69:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-03-24T07:10:37.155Z","userId":1}
User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:37.277Z' }
User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:37.301Z' }
error: Error fetching lab results: {"error":"desc is not defined","stack":"ReferenceError: desc is not defined\n    at <anonymous> (/home/runner/workspace/server/routes/labs.ts:33:49)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at requireAuth (/home/runner/workspace/server/routes.ts:62:5)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at jsonParser (/home/runner/workspace/node_modules/body-parser/lib/types/json.js:113:7)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at strategy.pass (/home/runner/workspace/node_modules/passport/lib/middleware/authenticate.js:355:9)\n    at /home/runner/workspace/node_modules/passport/lib/strategies/session.js:120:12\n    at pass (/home/runner/workspace/node_modules/passport/lib/authenticator.js:352:31)\n    at deserialized (/home/runner/workspace/node_modules/passport/lib/authenticator.js:364:7)\n    at <anonymous> (/home/runner/workspace/server/auth.ts:69:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-03-24T07:10:37.302Z","userId":1}
User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:44.703Z' }
User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:44.768Z' }
Express-file-upload: Temporary file path is /tmp/tmp-1-1742800244771
Express-file-upload: Opening write stream for file->TestBloodPanel.pdf...
Express-file-upload: New upload started file->TestBloodPanel.pdf, bytes:0
Express-file-upload: Uploading file->TestBloodPanel.pdf, bytes:13929...
Express-file-upload: Uploading file->TestBloodPanel.pdf, bytes:16233...
Express-file-upload: Uploading file->TestBloodPanel.pdf, bytes:32617...
Express-file-upload: Uploading file->TestBloodPanel.pdf, bytes:65385...
Express-file-upload: Uploading file->TestBloodPanel.pdf, bytes:73115...
Express-file-upload: Upload finished file->TestBloodPanel.pdf, bytes:73115
Express-file-upload: Upload file->TestBloodPanel.pdf completed, bytes:73115.
Express-file-upload: Busboy finished parsing request.
Express-file-upload: Moving temporary file /tmp/tmp-1-1742800244771 to /home/runner/workspace/uploads/1742800244864-TestBloodPanel.pdf
info: File moved to /home/runner/workspace/uploads/1742800244864-TestBloodPanel.pdf {"timestamp":"2025-03-24T07:10:44.866Z"}
info: Lab result saved: {"fileName":"TestBloodPanel.pdf","fileSize":73115,"fileUrl":"/uploads/1742800244864-TestBloodPanel.pdf","labId":22,"timestamp":"2025-03-24T07:10:44.913Z","userId":1}
info: Background summary generation started for lab ID: {"timestamp":"2025-03-24T07:10:44.913Z"}
error: Error parsing PDF: {"error":"ENOENT: no such file or directory, open './test/data/05-versions-space.pdf'","fileName":"TestBloodPanel.pdf","filePath":"/home/runner/workspace/uploads/1742800244864-TestBloodPanel.pdf","fileUrl":"/uploads/1742800244864-TestBloodPanel.pdf","stack":"Error: ENOENT: no such file or directory, open './test/data/05-versions-space.pdf'\n    at Object.openSync (node:fs:573:18)\n    at Object.readFileSync (node:fs:452:35)\n    at Object.<anonymous> (/home/runner/workspace/node_modules/pdf-parse/index.js:15:25)\n    at Module._compile (node:internal/modules/cjs/loader:1469:14)\n    at Object.transformer (/home/runner/workspace/node_modules/tsx/dist/register-DCnOAxY2.cjs:2:1186)\n    at Module.load (node:internal/modules/cjs/loader:1288:32)\n    at Module._load (node:internal/modules/cjs/loader:1104:12)\n    at cjsLoader (node:internal/modules/esm/translators:346:17)\n    at ModuleWrap.<anonymous> (node:internal/modules/esm/translators:286:7)\n    at ModuleJob.run (node:internal/modules/esm/module_job:234:25)","timestamp":"2025-03-24T07:10:44.943Z"}
User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:45.035Z' }
User deserialized: { userId: 1, timestamp: '2025-03-24T07:10:45.063Z' }
error: Error fetching lab results: {"error":"desc is not defined","stack":"ReferenceError: desc is not defined\n    at <anonymous> (/home/runner/workspace/server/routes/labs.ts:33:49)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at requireAuth (/home/runner/workspace/server/routes.ts:62:5)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at jsonParser (/home/runner/workspace/node_modules/body-parser/lib/types/json.js:113:7)\n    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)\n    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)\n    at strategy.pass (/home/runner/workspace/node_modules/passport/lib/middleware/authenticate.js:355:9)\n    at /home/runner/workspace/node_modules/passport/lib/strategies/session.js:120:12\n    at pass (/home/runner/workspace/node_modules/passport/lib/authenticator.js:352:31)\n    at deserialized (/home/runner/workspace/node_modules/passport/lib/authenticator.js:364:7)\n    at <anonymous> (/home/runner/workspace/server/auth.ts:69:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-03-24T07:10:45.064Z","userId":1}
info: Created embedding for lab result 22 {"timestamp":"2025-03-24T07:10:46.731Z"}
info: Generated summary for lab result 22 {"timestamp":"2025-03-24T07:10:46.732Z"}
info: Background summary generation completed for lab ID 22 {"timestamp":"2025-03-24T07:10:46.732Z"}
